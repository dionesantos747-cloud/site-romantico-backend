<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Site RomÃ¢ntico</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="preview azul" id="preview">
  <audio id="audioPlayer" controls style="display:none;"></audio>
  <div class="nome" id="nome"></div>
  <div class="mensagem" id="mensagem"></div>
  <div id="midias"></div>
  <div id="tempo"></div>
  <button id="btnCarta">ðŸ’Œ Abrir carta</button>
  <div class="carta" id="carta"></div>
</div>

<script src="js/main.js"></script>
<script>
const urlParams = new URLSearchParams(window.location.search);
const id = urlParams.get("id");

// Carregar dados do usuÃ¡rio via JSON
fetch("/data/users.json")
  .then(res => res.json())
  .then(users => {
    const data = users[id];
    if(!data) return alert("UsuÃ¡rio nÃ£o encontrado");

    if(!data.pago) {
      document.body.innerHTML = `
        <div style="text-align:center;font-family:'Playfair Display', serif;color:#fff;padding:40px;">
          <h1>Pagamento ainda nÃ£o confirmado ðŸ’–</h1>
          <p>Assim que aprovado, vocÃª poderÃ¡ acessar seu site personalizado.</p>
        </div>`;
      return;
    }

    // Exibir informaÃ§Ãµes do usuÃ¡rio
    const nomeEl = document.getElementById("nome");
    const msgEl = document.getElementById("mensagem");
    const cartaEl = document.getElementById("carta");
    const midiasEl = document.getElementById("midias");
    const audio = document.getElementById("audioPlayer");
    const tempoEl = document.getElementById("tempo");

    nomeEl.innerText = data.nome;
    msgEl.innerText = data.mensagem;
    cartaEl.innerText = data.carta;

    data.fotos.forEach(f => {
      if(f){
        const div = document.createElement("div");
        div.className = "photo";
        div.innerHTML = `<img src="${f}" style="width:100%">`;
        midiasEl.appendChild(div);
      }
    });

    if(data.musica){
      audio.src = data.musica;
      audio.style.display = "block";
    }

    // Contador de tempo juntos
    const dataInput = { value: data.dataInicio };
    setInterval(()=>{
      if(!dataInput.value) return;
      const inicio = new Date(dataInput.value);
      const agora = new Date();
      const diff = agora - inicio;
      if(diff < 0) return;
      const s = Math.floor(diff/1000)%60;
      const m = Math.floor(diff/60000)%60;
      const h = Math.floor(diff/3600000)%24;
      const d = Math.floor(diff/86400000)%30;
      const mo = Math.floor(diff/2592000000)%12;
      const a = Math.floor(diff/31536000000);
      const anoText = a===1?"ano":"anos";
      const mesText = mo===1?"mÃªs":"meses";
      const diaText = d===1?"dia":"dias";
      tempoEl.innerHTML = `<strong>JÃ¡ estamos juntos hÃ¡</strong><br>${a} ${anoText} â€¢ ${mo} ${mesText} â€¢ ${d} ${diaText}<br>${h}h ${m}m ${s}s`;
    },1000);
  });

// Carta secreta
const btnCarta = document.getElementById("btnCarta");
const carta = document.getElementById("carta");
btnCarta.onclick = () => {
  carta.style.display = carta.style.display==="block"?"none":"block";
  btnCarta.innerText = carta.style.display==="block"?"âŒ Fechar carta":"ðŸ’Œ Abrir carta";
};

// CoraÃ§Ãµes animados
function criarCoracoes(){
  document.querySelectorAll(".heart").forEach(h=>h.remove());
  for(let i=0;i<12;i++){
    const h=document.createElement("div");
    h.className="heart";
    h.innerText="â¤ï¸";
    h.style.left = Math.random()*100+"%";
    h.style.animationDuration = 6+Math.random()*6+"s";
    document.getElementById("preview").appendChild(h);
  }
}
criarCoracoes();
</script>
</body>
</html>
