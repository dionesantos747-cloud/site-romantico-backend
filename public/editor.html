<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Site Romântico</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial,sans-serif;
  overflow-x:hidden;
}

/* =====================
   CORREÇÃO DE CAMADAS
===================== */
.editor{
  position:relative;
  z-index:10; /* editor acima */
  padding:20px;
  background:#0d0f18;
}

.preview{
  position:relative;
  z-index:1; /* preview abaixo */
  min-height:100vh;
  padding:40px 16px 160px;
  text-align:center;
  overflow:hidden;
}

/* =====================
   FORMULÁRIO
===================== */
label{
  color:#ffb3d9;
  display:block;
  margin:14px 0 6px;
}
input,textarea{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
}
textarea{min-height:90px}

/* =====================
   FUNDOS
===================== */
.bg-options{
  display:flex;
  gap:12px;
  justify-content:center;
}
.bg-card{
  width:60px;height:60px;
  border-radius:14px;
  border:3px solid #000;
  cursor:pointer;
}
.bg-card.selected{border:3px solid #fff}
.azul{background:radial-gradient(circle,#2b6cff,#000)}
.roxo{background:radial-gradient(circle,#8a5cff,#000)}
.rosa{background:radial-gradient(circle,#ff5fa2,#000)}
.preto{background:radial-gradient(circle,#222,#000)}

/* =====================
   PREVIEW
===================== */
.nome{
  font-family:'Playfair Display', serif;
  font-size:3em;
  color:#ffd400;
}
.mensagem{
  font-family:'Playfair Display', serif;
  font-size:1.6em;
  font-style:italic;
}

/* =====================
   CORAÇÕES
===================== */
.heart{
  position:absolute;
  bottom:-20px;
  font-size:18px;
  animation:float 8s linear infinite;
  pointer-events:none;
}
@keyframes float{
  to{transform:translateY(-120vh);opacity:0}
}

/* =====================
   CONTADOR
===================== */
#tempo{margin-top:20px}
#tempo .titulo{
  font-family:'Playfair Display', serif;
  font-size:2em;
  color:#ffd400;
}
#tempo .contador{
  display:flex;
  justify-content:center;
  gap:10px;
}
#tempo .item{
  background:#fff;
  color:#333;
  padding:12px;
  border-radius:12px;
  font-family:'Playfair Display', serif;
}

/* =====================
   BOTÕES
===================== */
button{
  width:100%;
  padding:18px;
  border:none;
  border-radius:18px;
  margin-top:18px;
}
.pay{
  background:#ffd400;
  color:#000;
  font-weight:bold;
}
</style>
</head>

<body>

<!-- =====================
     EDITOR
===================== -->
<div class="editor" id="editor">

  <label>Nome</label>
  <input id="nomeInput">

  <label>Mensagem principal</label>
  <textarea id="msgInput"></textarea>

  <label>Carta secreta</label>
  <textarea id="cartaInput"></textarea>

  <label>Data de início</label>
  <input type="date" id="dataInput">

  <label>Fundo</label>
  <div class="bg-options">
    <div class="bg-card azul selected" data-bg="azul"></div>
    <div class="bg-card roxo" data-bg="roxo"></div>
    <div class="bg-card rosa" data-bg="rosa"></div>
    <div class="bg-card preto" data-bg="preto"></div>
  </div>

</div>

<!-- =====================
     PREVIEW
===================== -->
<div class="preview azul" id="preview">

  <div class="nome" id="nome"></div>
  <div class="mensagem" id="mensagem"></div>

  <div id="tempo"></div>

  <button class="pay" id="btnComprar">
    Gerar QR Code por R$9,99
  </button>

</div>

<script>
/* =====================
   VARIÁVEIS
===================== */
const nomeInput=document.getElementById("nomeInput");
const msgInput=document.getElementById("msgInput");
const cartaInput=document.getElementById("cartaInput");
const dataInput=document.getElementById("dataInput");
const nome=document.getElementById("nome");
const mensagem=document.getElementById("mensagem");
const tempo=document.getElementById("tempo");
const preview=document.getElementById("preview");

/* =====================
   PREVIEW AO VIVO
===================== */
nomeInput.oninput=()=>nome.innerText=nomeInput.value;
msgInput.oninput=()=>mensagem.innerText=msgInput.value;

/* =====================
   CONTADOR
===================== */
setInterval(()=>{
  if(!dataInput.value) return;
  const i=new Date(dataInput.value),a=new Date(),d=a-i;
  const s=Math.floor(d/1000)%60,
        m=Math.floor(d/60000)%60,
        h=Math.floor(d/3600000)%24,
        di=Math.floor(d/86400000)%30,
        mo=Math.floor(d/2592000000)%12,
        an=Math.floor(d/31536000000);
  tempo.innerHTML=`
    <div class="titulo">Já estamos juntos há</div>
    <div class="contador">
      <div class="item">${an} ${an===1?"ano":"anos"}</div>
      <div class="item">${mo} ${mo===1?"mês":"meses"}</div>
      <div class="item">${di} ${di===1?"dia":"dias"}</div>
      <div class="item">${h}h ${m}m ${s}s</div>
    </div>`;
},1000);

/* =====================
   CORAÇÕES
===================== */
function criarCoracoes(){
  document.querySelectorAll(".heart").forEach(h=>h.remove());
  for(let i=0;i<12;i++){
    const h=document.createElement("div");
    h.className="heart";
    h.innerText="❤️";
    h.style.left=Math.random()*100+"%";
    h.style.animationDuration=6+Math.random()*6+"s";
    preview.appendChild(h);
  }
}
criarCoracoes();

/* =====================
   FUNDOS
===================== */
document.querySelectorAll(".bg-card").forEach(c=>{
  c.onclick=()=>{
    document.querySelectorAll(".bg-card").forEach(x=>x.classList.remove("selected"));
    c.classList.add("selected");
    preview.className="preview "+c.dataset.bg;
    criarCoracoes();
  };
});

/* =====================
   COMPRA
===================== */
document.getElementById("btnComprar").onclick=async()=>{
  if(!nomeInput.value||!msgInput.value||!cartaInput.value||!dataInput.value){
    alert("Preencha todos os campos");
    return;
  }

  const res=await fetch("/create-payment",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      nome:nomeInput.value,
      mensagem:msgInput.value,
      carta:cartaInput.value,
      dataInicio:dataInput.value
    })
  });

  const data=await res.json();
  if(!data.payment_id){
    alert("Erro ao criar pagamento");
    return;
  }

  window.location.href=`/aguardando.html?payment_id=${data.payment_id}`;
};
</script>

</body>
</html>
</html>

