<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Site Rom√¢ntico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="color-scheme" content="only light">

  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
 <link href="https://fonts.googleapis.com/css2?family=Playfair+Display+SC:wght@700;900&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="/css/style.css?v=4">

</head>

<body>

<!-- =====================
     EDITOR
===================== -->
<div class="editor" id="editor">

  <label>Nome</label>
  <input type="text" id="nomeInput" placeholder="Ex: Maria ‚ù§Ô∏è">
  <div class="error-text">Campo n√£o preenchido</div>

  <label>Mensagem principal</label>
  <textarea id="msgInput" placeholder="Escreva algo especial..."></textarea>
  <div class="error-text">Campo n√£o preenchido</div>

 <label>Data de in√≠cio do namoro ou amizade</label>

<div class="date-box" id="dateBox">
  üìÖ Selecionar data
</div>

<input 
  type="date" 
  id="dataInput"
  hidden
>

<div class="error-text">Campo n√£o preenchido</div>
  <label>Fotos</label>
  <div class="photo-grid">
    <div class="photo-slot" data-slot="0">+</div>
    <div class="photo-slot" data-slot="1">+</div>
    <div class="photo-slot" data-slot="2">+</div>
  </div>
  <div id="thumbs" class="photo-grid"></div>
  <input type="file" id="fotoInput" accept="image/*" hidden>

  <label>M√∫sica</label>
 <div class="music-box" id="musicBox">
  üéµ Adicionar m√∫sica
</div>
  
<div id="cancelMusic" style="display:none; color:#ff4d88; margin-top:8px; cursor:pointer;">
  ‚ùå Cancelar carregamento
</div>
  
  <div class="remove-music" id="removeMusic">Remover m√∫sica</div>
  <input
  type="file"
  id="musicaInput"
  accept=".mp3,.mp4,audio/*,video/mp4"
  hidden
>
  <label>Fundo</label>
  <div class="bg-options">
    <div class="bg-card azul selected" data-bg="azul"></div>
    <div class="bg-card roxo" data-bg="roxo"></div>
    <div class="bg-card rosa" data-bg="rosa"></div>
    <div class="bg-card preto" data-bg="preto"></div>
  </div>

</div>


<!-- =====================
     PREVIEW (CELULAR)
===================== -->

  <div style="
    text-align:center;
    padding: 12px 0;
    font-family: 'Playfair Display', serif;
    font-size: 1.2em;
    color: #ffd400;
  ">
    Veja como vai ficar ‚¨áÔ∏è
  </div>
  <div class="device-preview">

  <div class="device-screen">

    <div class="device-top">
      <span class="chrome-url">memoryit.com/nossosite</span>
    </div>

    <div class="preview azul" id="preview">

    <div class="music-player" id="musicPlayer" style="display:none;">
  <button id="playBtn" class="play-btn">‚ñ∂</button>
  
  <div class="music-info">
    <span class="music-title">Nossa M√∫sica </span>
    <div class="progress-bar">
      <div class="progress"></div>
    </div>
  </div>
</div>

<audio id="audio">
</audio>
      <div class="nome" id="nome"></div>
      <div class="mensagem" id="mensagem"></div>

      <button id="lerBtn" class="ler-mais" style="display:none">
        Continuar lendo ‚¨áÔ∏è
      </button>

      <div id="midias"></div>
      <div id="tempo"></div>

    </div>
  </div>

</div>

<!-- =====================
     BOT√ÉO DE COMPRA
===================== -->
<div style="
  max-width: 420px;
  margin: 30px auto 80px;
  padding: 0 20px;
">
  <button class="pay" id="btnComprar">
    Gerar QR Code por R$9,99
  </button>
</div>

<!-- =====================
     SCRIPT PRINCIPAL
===================== -->
<script src="/js/editor.js"></script>
<script>
const musicBox = document.getElementById("musicBox");
const musicaInput = document.getElementById("musicaInput");
const audio = document.getElementById("audioPlayer");
const removeMusic = document.getElementById("removeMusic");

let musicaUrl = null;
let isPickingMusic = false;

/* =========================
   ABRIR SELETOR (ANTI BUG MOBILE)
========================= */
musicBox.addEventListener("click", (e) => {
  e.preventDefault();
  e.stopPropagation();

  if (isPickingMusic || musicaUrl) return;

  isPickingMusic = true;
  musicaInput.click();
});

/* =========================
   SELE√á√ÉO DE M√öSICA
========================= */
musicaInput.addEventListener("change", async () => {
  const file = musicaInput.files[0];

  // Usu√°rio cancelou
  if (!file) {
    isPickingMusic = false;
    return;
  }

  musicBox.innerText = "‚è≥ Enviando m√∫sica...";
  musicBox.style.pointerEvents = "none";

  const form = new FormData();
  form.append("file", file);

  try {
    const res = await fetch("/upload-music", {
      method: "POST",
      body: form
    });

    const data = await res.json();
    if (!data.url) throw new Error();

    musicaUrl = data.url;
    audio.src = musicaUrl;
    audio.style.display = "block";

    musicBox.innerText = "üéµ M√∫sica adicionada";
    removeMusic.style.display = "block";

  } catch (err) {
    alert("Erro ao enviar m√∫sica");
    musicBox.innerText = "üéµ Adicionar m√∫sica";
    musicBox.style.pointerEvents = "auto";
    musicaInput.value = "";
  }

  // üî• LIBERA CLIQUE AP√ìS O CICLO COMPLETO
  setTimeout(() => {
    isPickingMusic = false;
    musicBox.style.pointerEvents = "auto";
  }, 300);
});

/* =========================
   REMOVER M√öSICA
========================= */
removeMusic.addEventListener("click", () => {
  musicaUrl = null;

  audio.pause();
  audio.src = "";
  audio.style.display = "none";

  musicaInput.value = "";
  removeMusic.style.display = "none";

  musicBox.innerText = "üéµ Adicionar m√∫sica";
});
</script>
</body>
</html>










































































































































































































