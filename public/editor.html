<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Site Rom√¢ntico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="color-scheme" content="only light">

  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
 <link href="https://fonts.googleapis.com/css2?family=Playfair+Display+SC:wght@700;900&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="/css/style.css?v=4">

</head>

<body>

<!-- =====================
     EDITOR
===================== -->
<div class="editor" id="editor">

  <label>Nome</label>
  <input type="text" id="nomeInput" placeholder="Ex: Maria ‚ù§Ô∏è">
  <div class="error-text">Campo n√£o preenchido</div>

  <label>Mensagem principal</label>
  <textarea id="msgInput" placeholder="Escreva algo especial..."></textarea>
  <div class="error-text">Campo n√£o preenchido</div>

 <label>Data de in√≠cio do namoro ou amizade</label>

<div class="date-box" id="dateBox">
  üìÖ Selecionar data
</div>

<input 
  type="date" 
  id="dataInput"
  hidden
>

<div class="error-text">Campo n√£o preenchido</div>
  <label>Fotos</label>
  <div class="photo-grid">
    <div class="photo-slot" data-slot="0">+</div>
    <div class="photo-slot" data-slot="1">+</div>
    <div class="photo-slot" data-slot="2">+</div>
  </div>
  <div id="thumbs" class="photo-grid"></div>
  <input type="file" id="fotoInput" accept="image/*" hidden>

  <label>M√∫sica</label>
 <div class="music-box" id="musicBox">
  üéµ Adicionar m√∫sica
</div>
  
<div id="cancelMusic" style="display:none; color:#ff4d88; margin-top:8px; cursor:pointer;">
  ‚ùå Cancelar carregamento
</div>
  
  <div class="remove-music" id="removeMusic">Remover m√∫sica</div>
  <input
  type="file"
  id="musicaInput"
  accept=".mp3,.mp4,audio/*,video/mp4"
  hidden
>
  <label>Fundo</label>
  <div class="bg-options">
    <div class="bg-card azul selected" data-bg="azul"></div>
    <div class="bg-card roxo" data-bg="roxo"></div>
    <div class="bg-card rosa" data-bg="rosa"></div>
    <div class="bg-card preto" data-bg="preto"></div>
  </div>

</div>


<!-- =====================
     PREVIEW (CELULAR)
===================== -->

  <div style="
    text-align:center;
    padding: 12px 0;
    font-family: 'Playfair Display', serif;
    font-size: 1.2em;
    color: #ffd400;
  ">
    Veja como vai ficar ‚¨áÔ∏è
  </div>
  <div class="device-preview">

  <div class="device-screen">

    <div class="device-top">
      <span class="chrome-url">memoryit.com/nossosite</span>
    </div>

    <div class="preview azul" id="preview">

    <div class="music-player" id="musicPlayer" style="display:none;">
  <button id="playBtn" class="play-btn">‚ñ∂</button>
  
  <div class="music-info">
    <span class="music-title">Nossa M√∫sica </span>
    <div class="progress-bar">
      <div class="progress"></div>
    </div>
  </div>
</div>

<audio id="audio">
</audio>
      <div class="nome" id="nome"></div>
      <div class="mensagem" id="mensagem"></div>

      <button id="lerBtn" class="ler-mais" style="display:none">
        Continuar lendo ‚¨áÔ∏è
      </button>

      <div id="midias"></div>
      <div id="tempo"></div>

    </div>
  </div>

</div>

<!-- =====================
     BOT√ÉO DE COMPRA
===================== -->
<div style="
  max-width: 420px;
  margin: 30px auto 80px;
  padding: 0 20px;
">
  <button class="pay" id="btnComprar">
    Gerar QR Code por R$9,99
  </button>
</div>

<!-- =====================
     SCRIPT PRINCIPAL
===================== -->
<script src="/js/editor.js"></script>
<script>
const audio = document.getElementById("audio");
const playBtn = document.getElementById("playBtn");
const progress = document.querySelector(".progress");
const musicaInput = document.getElementById("musicaInput");
const musicPlayer = document.getElementById("musicPlayer");
const musicBox = document.getElementById("musicBox");
const cancelMusic = document.getElementById("cancelMusic");
const removeMusic = document.getElementById("removeMusic");

removeMusic.style.display = "none";

let currentObjectURL = null;

/* =========================
   ABRIR INPUT AO CLICAR NA CAIXA
========================= */

musicBox.addEventListener("click", () => {
  musicaInput.click();
});

/* =========================
   SELECIONAR M√öSICA
========================= */

function handleMusicSelect(e) {
  const file = e.target.files[0];
  if (!file) return;

  musicBox.innerHTML = "‚è≥ 0% carregando...";
  cancelMusic.style.display = "block";

  currentObjectURL = URL.createObjectURL(file);
  audio.src = currentObjectURL;

  audio.addEventListener("progress", updateProgress);

  audio.addEventListener("canplaythrough", () => {
    musicBox.innerHTML = "üéµ M√∫sica adicionada";
    musicPlayer.style.display = "flex";
    cancelMusic.style.display = "none";
    removeMusic.style.display = "block";
    audio.removeEventListener("progress", updateProgress);
  }, { once: true });
}

musicaInput.addEventListener("change", handleMusicSelect);

/* =========================
   PROGRESSO REAL
========================= */

function updateProgress() {
  if (audio.buffered.length > 0 && audio.duration > 0) {
    const percent = Math.min(
      (audio.buffered.end(0) / audio.duration) * 100,
      100
    );
    musicBox.innerHTML = `‚è≥ ${Math.floor(percent)}% carregando...`;
  }
}

/* =========================
   CANCELAR
========================= */

cancelMusic.addEventListener("click", resetMusic);

/* =========================
   REMOVER
========================= */

removeMusic.addEventListener("click", resetMusic);

function resetMusic() {
  audio.pause();
  audio.removeAttribute("src");
  audio.load();

  if (currentObjectURL) {
    URL.revokeObjectURL(currentObjectURL);
    currentObjectURL = null;
  }

  // RESET REAL DO INPUT (permite escolher o mesmo arquivo novamente)
  musicaInput.type = "text";
  musicaInput.type = "file";

  musicBox.innerHTML = "üéµ Adicionar m√∫sica";
  cancelMusic.style.display = "none";
  musicPlayer.style.display = "none";
  removeMusic.style.display = "none";
}

/* =========================
   PLAY / PAUSE
========================= */

playBtn.addEventListener("click", () => {
  if (audio.paused) {
    audio.play();
    playBtn.innerHTML = "‚ùö‚ùö";
  } else {
    audio.pause();
    playBtn.innerHTML = "‚ñ∂";
  }
});

/* =========================
   BARRA DE REPRODU√á√ÉO
========================= */

audio.addEventListener("timeupdate", () => {
  if (audio.duration) {
    const percent = (audio.currentTime / audio.duration) * 100;
    progress.style.width = percent + "%";
  }
});
</script>
</body>
</html>


































































































































































































